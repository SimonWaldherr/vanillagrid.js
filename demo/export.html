<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>VanillaGrid ‚Ä¢ Export & Print</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="../dist/vanillagrid.min.js"></script>
  <link rel="stylesheet" href="../dist/vanillagrid.min.css" />
  <style>
    * { box-sizing: border-box; }
    body { 
      padding: 24px; 
      background: linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%);
      font-family: system-ui, -apple-system, sans-serif;
      min-height: 100vh;
    }
    .container {
      max-width: 1400px;
      margin: 0 auto;
    }
    .header {
      background: white;
      padding: 24px;
      border-radius: 12px;
      margin-bottom: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .header h1 {
      margin: 0 0 8px;
      font-size: 28px;
      color: #111827;
    }
    .header p {
      margin: 0;
      color: #6b7280;
      font-size: 16px;
    }
    .export-panel { 
      background: white; 
      border: 2px solid #e5e7eb; 
      border-radius: 12px; 
      padding: 20px; 
      margin-bottom: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .export-panel h3 {
      margin: 0 0 16px;
      font-size: 18px;
      color: #111827;
    }
    .export-controls { 
      display: flex; 
      gap: 12px; 
      flex-wrap: wrap; 
      align-items: center;
    }
    .export-controls button {
      padding: 10px 16px;
      border: 1px solid #d1d5db;
      background: white;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s;
    }
    .export-controls button:hover {
      background: #f5f3ff;
      border-color: #8b5cf6;
      color: #6d28d9;
    }
    .export-controls select,
    .export-controls input {
      padding: 10px 12px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-size: 14px;
    }
    .export-controls input {
      width: 150px;
    }
    .grid-container {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    @media (max-width: 768px) {
      body { padding: 16px; }
      .header { padding: 16px; }
      .header h1 { font-size: 22px; }
      .export-panel { padding: 16px; }
      .grid-container { padding: 12px; }
    }
    @media print {
      body { background: white; padding: 0; }
      .export-panel, .no-print, .header { display: none !important; }
      .vg-toolbar, .vg-pager { display: none !important; }
      .grid-container { box-shadow: none; border-radius: 0; padding: 0; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header no-print">
      <h1>üíæ Export & Print Demo</h1>
      <p>Export data to CSV/Markdown formats or print directly from your browser</p>
    </div>
    
    <div class="export-panel no-print">
      <h3>üì• Export Options</h3>
      <div class="export-controls">
        <button id="export-csv">üìÑ Export CSV</button>
        <button id="export-md">üìù Export Markdown</button>
        <button id="print-table">üñ®Ô∏è Print Table</button>
        <select id="export-scope">
          <option value="page">Current Page Only</option>
          <option value="all">All Data (150 rows)</option>
        </select>
        <input id="filename" placeholder="filename" value="employees-export" />
      </div>
    </div>

    <div class="grid-container">
      <div id="export-grid"></div>
    </div>
  </div>

  <script>
    // Generate employee data
    const employees = Array.from({length: 150}, (_, i) => {
      const firstNames = ['Alice', 'Bob', 'Carol', 'David', 'Emma', 'Frank', 'Grace', 'Henry', 'Ivy', 'Jack'];
      const lastNames = ['Anderson', 'Brown', 'Clark', 'Davis', 'Evans', 'Fisher', 'Green', 'Harris', 'Johnson', 'King'];
      const departments = ['Engineering', 'Sales', 'Marketing', 'HR', 'Finance', 'Operations'];
      const titles = ['Manager', 'Senior', 'Associate', 'Coordinator', 'Specialist', 'Director'];
      
      const firstName = firstNames[i % firstNames.length];
      const lastName = lastNames[Math.floor(i / firstNames.length) % lastNames.length];
      const department = departments[i % departments.length];
      const title = titles[i % titles.length];
      
      return {
        id: i + 1,
        name: `${firstName} ${lastName}`,
        email: `${firstName.toLowerCase()}.${lastName.toLowerCase()}@company.com`,
        department,
        title: `${title} ${department}`,
        salary: Math.floor(Math.random() * 80000) + 40000,
        startDate: new Date(2020 + Math.floor(Math.random() * 4), Math.floor(Math.random() * 12), Math.floor(Math.random() * 28) + 1).toISOString().split('T')[0],
        status: Math.random() > 0.1 ? 'Active' : 'Inactive',
        location: ['New York', 'San Francisco', 'London', 'Tokyo'][i % 4]
      };
    });

    const grid = new VanillaGrid('#export-grid', {
      data: employees,
      columns: [
        { key: 'id', label: 'ID', type: 'number', sortable: true },
        { key: 'name', label: 'Name', sortable: true },
        { key: 'email', label: 'Email', sortable: true },
        { key: 'department', label: 'Department', sortable: true },
        { key: 'title', label: 'Title', sortable: true },
        { 
          key: 'salary', 
          label: 'Salary', 
          type: 'number', 
          sortable: true,
          format: (value) => `$${value.toLocaleString()}`
        },
        { key: 'startDate', label: 'Start Date', sortable: true },
        { key: 'status', label: 'Status', sortable: true },
        { key: 'location', label: 'Location', sortable: true }
      ],
      filterable: true,
      groupable: true,
      pageSize: 20,
      columnsMenu: { 
        location: 'pager', 
        showSearch: true, 
        showSelectAll: true,
        exclude: ['email'] // Don't allow hiding email column
      },
      exporting: { 
        enabled: true, 
        formats: ['csv', 'md'],
        scope: 'page',
        filename: 'employees'
      }
    });

    // Custom export handlers
    document.getElementById('export-csv').onclick = () => {
      const scope = document.getElementById('export-scope').value;
      const filename = document.getElementById('filename').value || 'export';
      
      // Temporarily change export scope
      const originalScope = grid.opts.exporting.scope;
      const originalFilename = grid.opts.exporting.filename;
      grid.opts.exporting.scope = scope;
      grid.opts.exporting.filename = filename;
      
      grid.downloadCSV();
      
      // Restore original settings
      grid.opts.exporting.scope = originalScope;
      grid.opts.exporting.filename = originalFilename;
    };

    document.getElementById('export-md').onclick = () => {
      const scope = document.getElementById('export-scope').value;
      const filename = document.getElementById('filename').value || 'export';
      
      // Temporarily change export scope
      const originalScope = grid.opts.exporting.scope;
      const originalFilename = grid.opts.exporting.filename;
      grid.opts.exporting.scope = scope;
      grid.opts.exporting.filename = filename;
      
      grid.downloadMarkdown();
      
      // Restore original settings
      grid.opts.exporting.scope = originalScope;
      grid.opts.exporting.filename = originalFilename;
    };

    document.getElementById('print-table').onclick = () => {
      window.print();
    };
  </script>
</body>
</html>